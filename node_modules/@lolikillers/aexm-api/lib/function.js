const cheerio = require("cheerio")
const axios = require("axios")
const qs = require("qs")
const ytdl = require('ytdl-core');
const getLyrics = require('./getLyrics')
const getSong = require('./getSong')

function otakudesu(judul){
	return new Promise(async(resolve, reject) => {
	axios.get('https://otakudesu.moe/?s=' + judul + '&post_type=anime')
	.then(({ data }) => {
	const $ = cheerio.load(data)
	const result = {};
	let limk = $('#venkonten > div > div.venser > div > div > ul > li:nth-child(1) > h2 > a').attr('href')
	axios.get(limk).then(({ data }) => {
	const $$ = cheerio.load(data)
	result.message = 'I Am Loli'
	result.img = $$('#venkonten > div.venser > div.fotoanime').find('img').attr('src')
	$$('#venkonten > div.venser > div.fotoanime > div.infozin > div').each(function(a, b) {
		result.judul = $$(b).find('p:nth-child(1)').text().replace('Judul: ','')
		result.jepang = $$(b).find('p:nth-child(2)').text().replace('Japanese: ','')
		result.rate = $$(b).find('p:nth-child(3)').text().replace('Skor: ','')
		result.produser = $$(b).find('p:nth-child(4)').text().replace('Produser: ','')
		result.tipe = $$(b).find('p:nth-child(5)').text().replace('Tipe: ','')
		result.status = $$(b).find('p:nth-child(6)').text().replace('Status: ','')
		result.episode = $$(b).find('p:nth-child(7)').text().replace('Total Episode: ','')
		result.durasi = $$(b).find('p:nth-child(8)').text().replace('Durasi: ','')
		result.rilis = $$(b).find('p:nth-child(9)').text().replace('Tanggal Rilis: ','')
		result.studio = $$(b).find('p:nth-child(10)').text().replace('Studio: ','')
		result.genre = $$(b).find('p:nth-child(11)').text().replace('Genre: ','')
		result.desc = $$('#venkonten > div.venser > div.fotoanime > div.sinopc').text().replace('.','\n') + $$(b).find('div.sinopc > p:nth-child(2)').text()
		result.batch = $$('#venkonten > div.venser > div:nth-child(10) > ul > li > span:nth-child(1) > a').attr('href')
	})
	const lim = $$('#venkonten > div.venser > div:nth-child(10) > ul > li > span:nth-child(1) > a').attr('href')
	axios.get(lim).then(({ data }) => {
	const $$$ = cheerio.load(data)
		result.batchSD = $$$('#venkonten > div:nth-child(6) > ul > li:nth-child(1) > a:nth-child(3)').attr('href')
		result.batchHD = $$$('#venkonten > div:nth-child(6) > ul > li:nth-child(3) > a:nth-child(3)').attr('href')
		resolve(result)
				})
			})
		})
	.catch(reject)
	})
}

function covi(){
    return new Promise(async(resolve, reject) => {
    axios.get('https://onlineradiobox.com/id/trax/playlist/')
        .then(({ data }) => {
            const $ = cheerio.load(data)
                const tr = $('tr.active > td.track_history_item').find('a.ajax').text()
                const tr2 = $('tr:nth-child(2) > td.track_history_item').find('a.ajax').text()
                const tr3 = $('tr:nth-child(3) > td.track_history_item').find('a.ajax').text()
                const tr4 = $('tr:nth-child(4) > td.track_history_item').find('a.ajax').text()
                const tr5 = $('tr:nth-child(5) > td.track_history_item').find('a.ajax').text()
                const tr6 = $('tr:nth-child(6) > td.track_history_item').find('a.ajax').text()
                const result = {
                        track: tr,
                        last1: tr2,
                        last2: tr3,
                        last3: tr4,
                        last4: tr5,
                        last5: tr6
                }
            resolve(result)
            console.log(result)
        })
        .catch(reject)
    })
}

function covid(){
    return new Promise(async(resolve, reject) => {
    axios.get('https://www.mediafire.com/file/f6ia1g3tkwcxlph/video_2022-02-22_09-08-46.mp4/file')
        .then(({ data }) => {
            const $ = cheerio.load(data)
                const tr = $('div.download_link').find('a.input').attr('href')

                const result = {
                        track: tr,
                }
            resolve(result)
            console.log(result)
        })
        .catch(reject)
    })
}


function pinterest(query){
    return new Promise(async(resolve, reject) => {
    axios.get(query)
        .then(({ data }) => {
            const $ = cheerio.load(data)
                const tr = $('div.col-xs-12').find('a.btn').attr('href')
                const result = {
                        link: tr
                }
            resolve(result)
            console.log(result)
        })
        .catch(reject)
    })
}


function delta(query){
    return new Promise(async(resolve, reject) => {
    axios.get(query)
        .then(({ data }) => {
            const $ = cheerio.load(data)
                const tr = $('div.download_link').find('a.input').attr('href')
                const result = {
                		link: tr
                }
            resolve(result)
            console.log(result)
        })
        .catch(reject)
    })
}


function radio1(){
    return new Promise(async(resolve, reject) => {
    axios.get('https://onlineradiobox.com/id/')
        .then(({ data }) => {
            const $ = cheerio.load(data)
            let hasil = [];
            $('ul.stations-list > li.stations__station').each(function(i, elem) {
            	let t = $(this).find('figure.stations__station__title > a').text()
            	  let ly2 = t.replace(/\n/g, "");
            	  let t2 = ly2.replace(/\t/g, "");
                hasil[i] = {
                	radio: t2,
                	track: $(this).find('div.stations__station__track > a').text()
                }
            });
            resolve(hasil)
            console.log(hasil)
        })
        .catch(reject)
    })
}

function radio2(){
    return new Promise(async(resolve, reject) => {
    axios.get('https://onlineradiobox.com/id/')
        .then(({ data }) => {
            const $ = cheerio.load(data)
            let hasil = [];
            $('ul.stations-list > li.stations__station').each(function(i, elem) {
            	let t = $(this).find('figure.stations__station__title > a').text()
            	  let ly2 = t.replace(/\n/g, "");
            	  let t2 = ly2.replace(/\t/g, "");
            	  let s = $(this).find('div.stations__station__track > a').text()
                hasil[i] = {
                	radiolive: `${t2} - ${s}`
                }
            });
            resolve(hasil)
            console.log(hasil)
        })
        .catch(reject)
    })
}

function tebakgambar(){
    return new Promise(async(resolve, reject) => {
    axios.get('https://onlineradiobox.com/id/hardrockjakarta/playlist/?cs=id.pramborssurabaya')
        .then(({ data }) => {
            const $ = cheerio.load(data)
                const tr = $('tr.active > td.track_history_item').find('a.ajax').text()
                const tr2 = $('tr:nth-child(2) > td.track_history_item').find('a.ajax').text()
                const tr3 = $('tr:nth-child(3) > td.track_history_item').find('a.ajax').text()
                const tr4 = $('tr:nth-child(4) > td.track_history_item').find('a.ajax').text()
                const tr5 = $('tr:nth-child(5) > td.track_history_item').find('a.ajax').text()
                const tr6 = $('tr:nth-child(6) > td.track_history_item').find('a.ajax').text()
                const tr7 = $('tr:nth-child(7) > td.track_history_item').find('a.ajax').text()
                const tr8 = $('tr:nth-child(8) > td.track_history_item').find('a.ajax').text()
                const tr9 = $('tr:nth-child(9) > td.track_history_item').find('a.ajax').text()
                const tr10 = $('tr:nth-child(10) > td.track_history_item').find('a.ajax').text()
                const tr11 = $('tr:nth-child(11) > td.track_history_item').find('a.ajax').text()
                const result = {
                        track: tr,
                        last1: tr2,
                        last2: tr3,
                        last3: tr4,
                        last4: tr5,
                        last5: tr6,
                        last1: tr7,
                        last2: tr8,
                        last3: tr9,
                        last4: tr10,
                        last5: tr11
                }
            resolve(result)
            console.log(result)
        })
        .catch(reject)
    })
}

function ongoing(){
    return new Promise(async(resolve, reject) => {
    axios.get('https://onlineradiobox.com/id/prambors/playlist/?cs=id.pramborssurabaya')
        .then(({ data }) => {
            const $ = cheerio.load(data)
                const tr = $('tr.active > td.track_history_item').find('a.ajax').text()
                const tr2 = $('tr:nth-child(2) > td.track_history_item').find('a.ajax').text()
                const tr3 = $('tr:nth-child(3) > td.track_history_item').find('a.ajax').text()
                const tr4 = $('tr:nth-child(4) > td.track_history_item').find('a.ajax').text()
                const tr5 = $('tr:nth-child(5) > td.track_history_item').find('a.ajax').text()
                const tr6 = $('tr:nth-child(6) > td.track_history_item').find('a.ajax').text()
                const result = {
                        track: tr,
                        last1: tr2,
                        last2: tr3,
                        last3: tr4,
                        last4: tr5,
                        last5: tr6
                }
            resolve(result)
            console.log(result)
        })
        .catch(reject)
    })
}

function komiku(judul) {
	return new Promise(async(resolve,reject) => {
	axios.get('https://data3.komiku.id/cari/?post_type=manga&s=' + encodeURIComponent(judul))
	.then(({ data }) => {
	const $ = cheerio.load(data)
	const img = []; 
	const or = [];
	const ind = [];
	const up = [];
	const des = [];
	const li = [];
	const ch = [];
	const ch1 = [];
	$('div.daftar').each(function (a,b) {
		img.push($(b).find('img').attr('data-src'))
	$('div.kan').each(function(c,d) {
		or.push($(d).find('h3').text().trim())
		ind.push($(d).find('span.judul2').text())
		li.push('https://komiku.id' + $(d).find('a').attr('href'))
		up.push($(d).find('p').text().trim().split('. ')[0])
		des.push($(d).find('p').text().trim().split('. ')[1])
		ch1.push($(d).find('div:nth-child(5) > a').attr('title'))
	$('div.new1').each(function(e,f) {
		ch.push($(f).find('a').attr('title'))
		})
	})
})
	for (let i = 0 ; i < img.length; i++) {
		resolve({
			image: img[i],
			title: or[i],
			indo: ind[i],
			update: up[i],
			desc: des[i],
			chapter_awal: ch[i],
			chapter_akhir: ch1[i],
			link: li[i]
		})
	}
})
	.catch(reject)
	})
} 

function surah(no){
	return new Promise(async(resolve, reject) => {
		axios.get('https://kalam.sindonews.com/surah/' + no)
		.then(({ data }) => {
			const $ = cheerio.load(data)
			const result = [];
			const ar = [];
			const id = [];
			const lt = [];
			const au = [];
			$('div.breadcrumb-new > ul > li:nth-child(5)').each(function(c,d) {
			result.audio = $(d).find('a').attr('href').replace('surah','audioframe')
			})
			$('div.ayat-arab').each(function(a, b) {
				ar.push($(b).text()) 
			})
			$('li > div.ayat-text').each(function(e, f) {
				id.push($(f).text().replace(',','').trim()) })
			$('div.ayat-latin').each(function(g, h) {
				lt.push($(h).text().trim())	})
			for(let i = 0; i < ar.length ; i++){
			result.push({
				arab: ar[i],
				indo: id[i],
				latin: lt[i],
			})
		}
			resolve(result)
		})
		.catch(reject)
	})
}
function sholat(NO) {
	return new Promise(async(resolve, reject) =>{
		axios.get('https://kalam.sindonews.com/jadwalsholat/' + NO).then(({ data }) => {
			const $ = cheerio.load(data)
			const result = {};
			$('div.imsakiyah-content').each(function(a, b) {
			result.Tanggal = $(b).find('tr:nth-child(1) > td:nth-child(1)').text()
			result.imsak = $(b).find('tr:nth-child(1) > td:nth-child(2)').text()
			result.subuh = $(b).find('tr:nth-child(1) > td:nth-child(3)').text()
			result.zuhur = $(b).find('tr:nth-child(1) > td:nth-child(4)').text()
			result.ashar = $(b).find('tr:nth-child(1) > td:nth-child(5)').text()
			result.maghrib = $(b).find('tr:nth-child(1) > td:nth-child(6)').text()
			result.isya = $(b).find('tr:nth-child(1) > td:nth-child(7)').text()
			})
			resolve(result)
		})
		.catch(reject)
	})
}

function lirik(query, artist){
	return new Promise(async(resolve, reject) => {
        const options = {
    apiKey: 'Qq_HUaCKiiZuQ08WZI9_PjGAwDAho4sG3SkZjBvz-B-XZBmvPeABPxBAkwsnCJXa',
    title: query,
    artist: artist,
    optimizeQuery: true
};
   		axios.get('https://www.musixmatch.com/search/' + query)
   		.then(async({ data }) => {
		  	const hsl = getLyrics(options)
	   resolve(hsl)
       console.log(hsl)
   })
   .catch(reject)
   })
}

function image(query, artist){
    return new Promise(async(resolve, reject) => {
        const options = {
    apiKey: 'Qq_HUaCKiiZuQ08WZI9_PjGAwDAho4sG3SkZjBvz-B-XZBmvPeABPxBAkwsnCJXa',
    title: query,
    artist: artist,
    optimizeQuery: true
};
        axios.get('https://www.musixmatch.com/search/' + query)
        .then(async({ data }) => {
getSong(options).then((song) =>
    resolve(song.albumArt)
);
   })
   .catch(reject)
   })
}


function lirik2(query){
    return new Promise(async(resolve, reject) => {
        axios.get(`https://www.musixmatch.com/search/${query}`)
        .then(async({ data }) => {
        const $ = cheerio.load(data)
        const hasil = {};
        let limk = 'https://www.musixmatch.com'
        const link = limk + $('div.media-card-body > div > h2').find('a').attr('href')
            await axios.get(link)
            .then(({ data }) => {
                const $$ = cheerio.load(data)
                hasil.thumb = 'https:' + $$('.banner-album-image-desktop').find('img').attr('src')
                $$('.mxm-lyrics__content').each(function(a,b) {
           hasil.lirik = $$('span > p.mxm-lyrics__content ').find('.lyrics__content__ok').text() + $$(b).find('.lyrics__content__ok').text()
           hasil.judul = `${$$('title').text().replace(" Lyrics | Musixmatch","")}`
           })
       })
       resolve(hasil)
       console.log(hasil)
   })
   .catch(reject)
    })
}

function mnc(query){
    return new Promise(async(resolve, reject) => {
    axios.get('https://tinyurl.com/'+ query +'01')
        .then(({ data }) => {
            const $ = cheerio.load(data)
            let hasil = [];
                hasil = {
                	id:`${$('h2.tm-channel-label').find('div.tm-channel-name').text()}`,
                	link:`https://tony211259.github.io/redirect/${query}.html`,
                	img:`https://www.mncvision.id/${$('div.panel > div.panel-body').find('img').attr('src')}`,
                	desc:`${$('div.panel').find('p').text()}`,
					now_playing:`${$('div.tm-channel-schedule-nowplaying').find('a').text()} : <small>${$('div.tm-channel-schedule-nowplaying').find('span').text()}</small>`,
                	jadwal_1:`${$('table').find('tr:nth-child(1) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(1) > td.nowrap').text()}</small>`,
                	jadwal_2:`${$('table').find('tr:nth-child(2) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(2) > td.nowrap').text()}</small>`, 
                	jadwal_3:`${$('table').find('tr:nth-child(3) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(3) > td.nowrap').text()}</small>`, 
                	jadwal_4:`${$('table').find('tr:nth-child(4) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(4) > td.nowrap').text()}</small>`, 
                	jadwal_5:`${$('table').find('tr:nth-child(5) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(5) > td.nowrap').text()}</small>`,
                	jadwal_6:`${$('table').find('tr:nth-child(6) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(6) > td.nowrap').text()}</small>`,
                	jadwal_7:`${$('table').find('tr:nth-child(7) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(7) > td.nowrap').text()}</small>`,
                	jadwal_8:`${$('table').find('tr:nth-child(8) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(8) > td.nowrap').text()}</small>`,
                	jadwal_9:`${$('table').find('tr:nth-child(9) > td > a.tm-program-title').text()} : <small>${$('table').find('tr:nth-child(9) > td.nowrap').text()}</small>`
                }
            resolve(hasil)
            console.log(hasil)
        })
        .catch(reject)
    })
}

function joox(query){
    return new Promise(async(resolve, reject) => {
    axios.get(query)
        .then(({ data }) => {
            const $ = cheerio.load(data)
            let hasil = [];
            	let t = $('div.download_link').find('a.input').attr('href')
                hasil = {
                	link2: t
                }
            resolve(hasil)
            console.log(hasil)
        })
        .catch(reject)
    })
}

async function jood(query) {
  return new Promise((resolve, reject) => {
    const time = Math.floor(new Date() / 1000)
    axios.get('http://api.joox.com/web-fcgi-bin//web_search?lang=id&country=id&type=0&search_input=' + query + '&pn=1&sin=0&ein=29&_=' + time)
      .then(({
        data
      }) => {
        let result = []
        let hasil = []
        let promoses = []
        let ids = []
        data.itemlist.forEach(result => {
          ids.push(result.songid)
        });
        for (let i = 0; i < data.itemlist.length; i++) {
          const get = 'http://api.joox.com/web-fcgi-bin/web_get_songinfo?songid=' + ids[i]
          promoses.push(
            axios.get(get, {
              headers: {
                Cookie: 'wmid=142420656; user_type=1; country=id; session_key=2a5d97d05dc8fe238150184eaf3519ad;'
              }
            })
            .then(({
              data
            }) => {
              const res = JSON.parse(data.replace('MusicInfoCallback(', '').replace('\n)', ''))
              hasil.push({
                lagu: res.msong,
                album: res.malbum,
                penyanyi: res.msinger,
                publish: res.public_time,
                img: res.imgSrc,
                mp3: res.mp3Url
              })

              axios.get('http://api.joox.com/web-fcgi-bin/web_lyric?musicid=' + ids[i] + '&lang=id&country=id&_=' + time)
                .then(({
                  data
                }) => {
                  const lirik = JSON.parse(data.replace('MusicJsonCallback(', '').replace('\n)', '')).lyric
                  const buff = new Buffer.from(lirik, 'base64')
                  const ash = buff.toString('utf-8')
                  result.push({
                    result: ash
                  })
                  Promise.all(promoses).then(() => resolve({
                    status: 200,
                    data: hasil,
                    lirik: result
                  }))
                }).catch(reject)
            }).catch(reject)
          )
        }
      }).catch(reject)
  })
}


function chara(query) {
	return new Promise((resolve, reject) => {
		axios.get('https://www.wallpaperflare.com/search?wallpaper='+ query,{
			headers: {
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "_ga=GA1.2.863074474.1624987429; _gid=GA1.2.857771494.1624987429; __gads=ID=84d12a6ae82d0a63-2242b0820eca0058:T=1624987427:RT=1624987427:S=ALNI_MaJYaH0-_xRbokdDkQ0B49vSYgYcQ"
			}
		})
		.then(({ data }) => {
			const $ = cheerio.load(data)
			const result = [];
			$('#gallery > li > figure > a').each(function(a, b) {
				result.push($(b).find('img').attr('data-src'))
			})
			resolve(result)
		})
	.catch({status: 'err'})
	})
}

function wattpad(judul){
	return new Promise((resolve, reject) => {
		axios.get('https://www.wattpad.com/search/' + judul)
		.then(({data}) => {
			const $ = cheerio.load(data)
			const result = [];
			const jdl = [];
			const img = [];
			const des = [];
			const lnk = [];
			const red = [];
			const vt = [];
			const limk = 'https://www.wattpad.com/'
			$('div.cover.cover-xs.pull-left').each(function(a,b){
				img.push($(b).find('img').attr('src')) 
			})
			$('div.content > h5').each(function(a,b) {
				jdl.push($(b).text().trim())
			})	
			$('div.content > p').each(function(a,b){
				des.push($(b).text().trim())
			})	
			$('#results-stories > div > ul > li').each(function(a,b){
				lnk.push(limk + $(b).find('a.on-result').attr('data-id'))
			})
			$('div.content > div > small.reads').each(function(a,b){
				red.push($(b).text())
			})
			$('div.content > div > small.votes').each(function(a, b) {
				vt.push($(b).text())
			})
		for (let i = 0; i < lnk.length; i++){
			result.push({
					judul: jdl[i],
					desc: des[i],
					vote: vt[i],
					reads: red[i],
					image: img[i],
					link: lnk[i]
			})
			resolve(result)
		}
		})
	.catch({message: 'err'})
	})
}

function playstore(name){
	return new Promise((resolve, reject) => {
		axios.get('https://play.google.com/store/search?q='+ name +'&c=apps')
		.then(({ data }) => {
			const $ = cheerio.load(data)
			let ln = [];
			let nm = [];
			let dv = [];
			let lm = [];
			const result = [];
			$('div.wXUyZd > a').each(function(a,b){
				const link =  'https://play.google.com' + $(b).attr('href')
				ln.push(link);
			})
			$('div.b8cIId.ReQCgd.Q9MA7b > a > div').each(function(d,e){
				const name = $(e).text().trim()
				nm.push(name);
			})
			$('div.b8cIId.ReQCgd.KoLSrc > a > div').each(function(f,g){
				const dev = $(g).text().trim();
				dv.push(dev)
			})
			$('div.b8cIId.ReQCgd.KoLSrc > a').each(function(h,i){
				const limk = 'https://play.google.com' + $(i).attr('href');
				lm.push(limk);
			})			
		for (let i = 0; i < ln.length; i++){
			result.push({
				name: nm[i],
				link: ln[i],
				developer: dv[i],
				link_dev: lm[i]
			})
	}
		resolve(result)
		})
	.catch(reject)
	})
}

function linkwa(nama){
	return new Promise((resolve,reject) => {
		axios.get('http://ngarang.com/link-grup-wa/daftar-link-grup-wa.php?search='+ nama +'&searchby=name')
		.then(({ data }) => {
			const $ = cheerio.load(data);
			const result = [];
			const lnk = [];
			const nm = [];
		$('div.wa-chat-title-container').each(function(a,b){
			const limk = $(b).find('a').attr('href');
			lnk.push(limk)
			})
		$('div.wa-chat-title-text').each(function(c,d) {
			const name = $(d).text();
			nm.push(name)
			})
		for( let i = 0; i < lnk.length; i++){
			result.push({
				nama: nm[i].split('. ')[1],
				link: lnk[i].split('?')[0]
			})
		}
		resolve(result)
		})
	.catch(reject)
	})
}



function igdl(url){
	return new Promise(async(resolve, reject) => {
		axios.request({
			url: 'https://www.instagramsave.com/download-instagram-videos.php',
			method: 'GET',
			headers:{
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "PHPSESSID=ugpgvu6fgc4592jh7ht9d18v49; _ga=GA1.2.1126798330.1625045680; _gid=GA1.2.1475525047.1625045680; __gads=ID=92b58ed9ed58d147-221917af11ca0021:T=1625045679:RT=1625045679:S=ALNI_MYnQToDW3kOUClBGEzULNjeyAqOtg"
			}
		})
		.then(({ data }) => {
			const $ = cheerio.load(data)
			const token = $('#token').attr('value')
			let config ={
				headers: {
					'content-type': 'application/x-www-form-urlencoded; charset=UTF-8',
					"sec-ch-ua": '" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',
					"cookie": "PHPSESSID=ugpgvu6fgc4592jh7ht9d18v49; _ga=GA1.2.1126798330.1625045680; _gid=GA1.2.1475525047.1625045680; __gads=ID=92b58ed9ed58d147-221917af11ca0021:T=1625045679:RT=1625045679:S=ALNI_MYnQToDW3kOUClBGEzULNjeyAqOtg",
					"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				},
				data: {
					'url': url,
					'action': 'post',
					'token': token
				}
			}
		axios.post('https://www.instagramsave.com/system/action.php',qs.stringify(config.data), { headers: config.headers })
		.then(({ data }) => {
		resolve(data.medias)
		   })
		})
	.catch(reject)
	})
}

function igstory(username){
	return new Promise(async(resolve, reject) => {
		axios.request({
			url: 'https://www.instagramsave.com/instagram-story-downloader.php',
			method: 'GET',
			headers:{
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "PHPSESSID=ugpgvu6fgc4592jh7ht9d18v49; _ga=GA1.2.1126798330.1625045680; _gid=GA1.2.1475525047.1625045680; __gads=ID=92b58ed9ed58d147-221917af11ca0021:T=1625045679:RT=1625045679:S=ALNI_MYnQToDW3kOUClBGEzULNjeyAqOtg"
			}
		})
		.then(({ data }) => {
			const $ = cheerio.load(data)
			const token = $('#token').attr('value')
			let config ={
				headers: {
					'content-type': 'application/x-www-form-urlencoded; charset=UTF-8',
					"sec-ch-ua": '" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',
					"cookie": "PHPSESSID=ugpgvu6fgc4592jh7ht9d18v49; _ga=GA1.2.1126798330.1625045680; _gid=GA1.2.1475525047.1625045680; __gads=ID=92b58ed9ed58d147-221917af11ca0021:T=1625045679:RT=1625045679:S=ALNI_MYnQToDW3kOUClBGEzULNjeyAqOtg",
					"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				},
				data: {
					'url':'https://www.instagram.com/'+ username,
					'action': 'story',
					'token': token
				}
			}
		axios.post('https://www.instagramsave.com/system/action.php',qs.stringify(config.data), { headers: config.headers })
		.then(({ data }) => {
		resolve(data.medias)
		   })
		})
	.catch(reject)
	})
}

function igstalk(username){
	return new Promise((resolve,reject) => {
		axios.get('https://www.instagram.com/'+ username +'/?__a=1',{
			method: 'GET',
			headers: {
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.114 Safari/537.36",
				"cookie": "mid=XBXl1AALAAEbFoAEfNjZlMMG9dwX; ig_did=91E66A48-5AA2-445D-BFE6-84DC4456DE8F; fbm_124024574287414=base_domain=.instagram.com; ig_nrcb=1; shbid=\"12737\0544008624962\0541656157971:01f72a5102dc07af6845adf923ca70eb86e81ab95fa9dbfdaf157c9eef0e82fd1f10fe23\"; shbts=\"1624621971\0544008624962\0541656157971:01f74841fba8e77a0066b47ea891dec8fba6fdf9216c0816f9fb3532292f769828800ae2\"; fbsr_124024574287414=86D8femzH4_KFW4hd3Z6XFdowU6lG-uXsXRQDNl44VM.eyJ1c2VyX2lkIjoiMTAwMDA0Njc2MDc4Nzg5IiwiY29kZSI6IkFRQngzXzVOejdwVnBwby1LRGRUdEYxUFlzcUdDQXJjcmJfb05HaWFvYkNvOGtLN2paam50bHpvMTNOakFnTzVKOHQ5M0V3U3dvNkRtZ0RiY1l1Z3dQSTIybnExOUxLd3lpZTVfZll0bkNXZXBuM1hoYWFLX0w2R0pZaUpzaDBOTDBhb3pmTVBkRTVQRC12X3FnbUgxLXZYdGVmcHhfaFU0aUZNZVMxNHhFUk5OblJyMmxYTUpDa2RFYTdISXNCR2swdHhaaGF0NUt4UDR3cWZTamRwcVFfQ19sa1RUek5fU0taUTYtMjlzTkdnLUVWb3oxMUZWc3Q2OEx2ZnlIY0V0eFp0ZUxacXpiWmh6MzZrVl83VmFGd0FqVnVkTGFQN2VzT3ZRcmlTQ2pLUE5XbVcyNWhudzIzejJBSnVURW00YWR1cmN6a3ZLWU1icTd2SnN0SVdJV09RIiwib2F1dGhfdG9rZW4iOiJFQUFCd3pMaXhuallCQUJBZmJuQ3haQzZMd3h4MDFJV2MyZ3dsQ3k3Qmp0b05UNUY0WDY2NHBrUzRQeERNVXRsdmhWWkI3SXE0MGsyZ2hJQm55RHRPcW5iVjlPbUNiWGhyTFBaQUhBQjFzVFpBdHF6RFEzVTROUkhOU1V6MFVXWkNtTEdLcDNNWDRoazVIOURLbERHN0QwUlhZNHY4dHBCdVNNYjN4dnBTRGtQcHdYRlBXVU82VCIsImFsZ29yaXRobSI6IkhNQUMtU0hBMjU2IiwiaXNzdWVkX2F0IjoxNjI0NjIxOTgxfQ; fbsr_124024574287414=86D8femzH4_KFW4hd3Z6XFdowU6lG-uXsXRQDNl44VM.eyJ1c2VyX2lkIjoiMTAwMDA0Njc2MDc4Nzg5IiwiY29kZSI6IkFRQngzXzVOejdwVnBwby1LRGRUdEYxUFlzcUdDQXJjcmJfb05HaWFvYkNvOGtLN2paam50bHpvMTNOakFnTzVKOHQ5M0V3U3dvNkRtZ0RiY1l1Z3dQSTIybnExOUxLd3lpZTVfZll0bkNXZXBuM1hoYWFLX0w2R0pZaUpzaDBOTDBhb3pmTVBkRTVQRC12X3FnbUgxLXZYdGVmcHhfaFU0aUZNZVMxNHhFUk5OblJyMmxYTUpDa2RFYTdISXNCR2swdHhaaGF0NUt4UDR3cWZTamRwcVFfQ19sa1RUek5fU0taUTYtMjlzTkdnLUVWb3oxMUZWc3Q2OEx2ZnlIY0V0eFp0ZUxacXpiWmh6MzZrVl83VmFGd0FqVnVkTGFQN2VzT3ZRcmlTQ2pLUE5XbVcyNWhudzIzejJBSnVURW00YWR1cmN6a3ZLWU1icTd2SnN0SVdJV09RIiwib2F1dGhfdG9rZW4iOiJFQUFCd3pMaXhuallCQUJBZmJuQ3haQzZMd3h4MDFJV2MyZ3dsQ3k3Qmp0b05UNUY0WDY2NHBrUzRQeERNVXRsdmhWWkI3SXE0MGsyZ2hJQm55RHRPcW5iVjlPbUNiWGhyTFBaQUhBQjFzVFpBdHF6RFEzVTROUkhOU1V6MFVXWkNtTEdLcDNNWDRoazVIOURLbERHN0QwUlhZNHY4dHBCdVNNYjN4dnBTRGtQcHdYRlBXVU82VCIsImFsZ29yaXRobSI6IkhNQUMtU0hBMjU2IiwiaXNzdWVkX2F0IjoxNjI0NjIxOTgxfQ; csrftoken=PpiPMEl0R2pAwThsw4NXynO6cVIXHZDo; ds_user_id=38316792800; sessionid=38316792800:rQj5Tr3g5zkg7b:4; rur=\"RVA\05438316792800\0541656158332:01f759cf624bef147397144805bb4c26f6c8b36a232e0f5738c570ee492f6b629f84f6e5\""
			}
		})
		.then(({ data }) => {
			const user = data.graphql.user
			let result = {
				message: 'I Am Loli',
                id: user.id,
                biography: user.biography,
                followers: user.edge_followed_by.count,
                following: user.edge_follow.count,
                fullName: user.full_name,
                highlightCount: user.highlight_reel_count,
                isBusinessAccount: user.is_business_account,
                isRecentUser: user.is_joined_recently,
                accountCategory: user.business_category_name,
                linkedFacebookPage: user.connected_fb_page,
                isPrivate: user.is_private,
                isVerified: user.is_verified,
                profilePicHD: user.profile_pic_url_hd,
                username: user.username,
                postsCount: user.edge_owner_to_timeline_media.count
			}
		resolve(result)
		})
	.catch(reject)
	})
}

function twitter(link){
	return new Promise((resolve, reject) => {
		let config = {
			'URL': link
		}
		axios.post('https://twdown.net/download.php',qs.stringify(config),{
			headers: {
				"accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
				"sec-ch-ua": '" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "_ga=GA1.2.1388798541.1625064838; _gid=GA1.2.1351476739.1625064838; __gads=ID=7a60905ab10b2596-229566750eca0064:T=1625064837:RT=1625064837:S=ALNI_Mbg3GGC2b3oBVCUJt9UImup-j20Iw; _gat=1"
			}
		})
		.then(({ data }) => {
		const $ = cheerio.load(data)
		resolve({
				desc: $('div:nth-child(1) > div:nth-child(2) > p').text().trim(),
				thumb: $('div:nth-child(1) > img').attr('src'),
				HD: $('tbody > tr:nth-child(1) > td:nth-child(4) > a').attr('href'),
				SD: $('tr:nth-child(2) > td:nth-child(4) > a').attr('href'),
				audio: 'https://twdown.net/' + $('tr:nth-child(4) > td:nth-child(4) > a').attr('href')
			})
		})
	.catch(reject)
	})
}

function fbdown(link){
	return new Promise((resolve,reject) => {
	let config = {
		'url': link
		}
	axios('https://www.getfvid.com/downloader',{
			method: 'POST',
			data: new URLSearchParams(Object.entries(config)),
			headers: {
				"content-type": "application/x-www-form-urlencoded",
				"user-agent":  "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "_ga=GA1.2.1310699039.1624884412; _pbjs_userid_consent_data=3524755945110770; cto_bidid=rQH5Tl9NNm5IWFZsem00SVVuZGpEd21sWnp0WmhUeTZpRXdkWlRUOSUyQkYlMkJQQnJRSHVPZ3Fhb1R2UUFiTWJuVGlhVkN1TGM2anhDT1M1Qk0ydHlBb21LJTJGNkdCOWtZalRtZFlxJTJGa3FVTG1TaHlzdDRvJTNE; cto_bundle=g1Ka319NaThuSmh6UklyWm5vV2pkb3NYaUZMeWlHVUtDbVBmeldhNm5qVGVwWnJzSUElMkJXVDdORmU5VElvV2pXUTJhQ3owVWI5enE1WjJ4ZHR5NDZqd1hCZnVHVGZmOEd0eURzcSUyQkNDcHZsR0xJcTZaRFZEMDkzUk1xSmhYMlY0TTdUY0hpZm9NTk5GYXVxWjBJZTR0dE9rQmZ3JTNEJTNE; _gid=GA1.2.908874955.1625126838; __gads=ID=5be9d413ff899546-22e04a9e18ca0046:T=1625126836:RT=1625126836:S=ALNI_Ma0axY94aSdwMIg95hxZVZ-JGNT2w; cookieconsent_status=dismiss"
			}
		})
	.then(async({ data }) => {
		const $ = cheerio.load(data);	
		resolve({
			Normal_video: $('div.col-md-4.btns-download > p:nth-child(2) > a').attr('href'),
			HD: $('div.col-md-4.btns-download > p:nth-child(1) > a').attr('href'),
			audio: $('div.col-md-4.btns-download > p:nth-child(3) > a').attr('href')
			})
		})
	.catch(reject)
	})
}

function youtube(url){
    return new Promise(async(resolve, reject) => {
        ytdl.getInfo(url).then(async(getUrl) => {
            let result = [];
            for(let i = 0; i < getUrl.formats.length; i++) {
                let item = getUrl.formats[i];
                if (item.container == 'mp4' && item.hasVideo == true && item.hasAudio == true) {
                    let { qualityLabel, contentLength } = item;
                    result[i] = {
                        video: item.url,
                        quality: qualityLabel
                    };
                };
            };
            let title = getUrl.videoDetails.title;
            let desc = getUrl.videoDetails.description;
            let desk = desc.replace(/\n/g, "<br/>");
            let views = getUrl.videoDetails.viewCount;
            let likes = getUrl.videoDetails.likes;
            let dislike = getUrl.videoDetails.dislikes;
            let channel = getUrl.videoDetails.ownerChannelName;
            let uploadDate = getUrl.videoDetails.uploadDate;
            let thumb = getUrl.player_response.microformat.playerMicroformatRenderer.thumbnail.thumbnails[0].url;
            resolve({
                title,
                thumb,
                views,
                likes,
                dislike,
                channel,
                uploadDate,
                desk
            });
        }).catch(reject);
    });
};


function ttdownloader(url){
	return new Promise(async(resolve, reject) => {
		axios.get('https://ttdownloader.com/',{
			headers: {
				"accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "PHPSESSID=9ut8phujrprrmll6oc3bist01t; popCookie=1; _ga=GA1.2.1068750365.1625213061; _gid=GA1.2.842420949.1625213061"
			}
		})
		.then(({ data }) => {
			const $ = cheerio.load(data)
			let token = $('#token').attr('value')
			let config = {
				'url': url,
				'format': '',
				'token': token
			}
		axios('https://ttdownloader.com/req/',{
			method: 'POST',
			data : new URLSearchParams(Object.entries(config)),
			headers: {
				"accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
				"user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
				"cookie": "PHPSESSID=9ut8phujrprrmll6oc3bist01t; popCookie=1; _ga=GA1.2.1068750365.1625213061; _gid=GA1.2.842420949.1625213061"
			}
			})
		.then(({ data }) => {
			const $ = cheerio.load(data)
			resolve({
				message: 'I Am Loli',
				nowm: $('div:nth-child(2) > div.download > a').attr('href'),
				wm: $('div:nth-child(3) > div.download > a').attr('href'),
				audio: $('div:nth-child(4) > div.download > a').attr('href')
				})
			})
		})
	.catch(reject)
	})
}

module.exports.otakudesu = otakudesu
module.exports.covid = covid
module.exports.delta = delta
module.exports.radio1 = radio1
module.exports.radio2 = radio2
module.exports.ongoing = ongoing
module.exports.komiku = komiku
module.exports.tebakgambar = tebakgambar
module.exports.surah = surah
module.exports.sholat = sholat
module.exports.lirik = lirik
module.exports.image = image
module.exports.lirik2 = lirik2
module.exports.mnc = mnc
module.exports.joox = joox
module.exports.chara = chara
module.exports.wattpad = wattpad
module.exports.playstore = playstore
module.exports.linkwa = linkwa
module.exports.pinterest = pinterest
module.exports.igdl = igdl
module.exports.igstory = igstory
module.exports.igstalk = igstalk
module.exports.twitter = twitter
module.exports.fbdown = fbdown
module.exports.youtube = youtube
module.exports.ttdownloader = ttdownloader



