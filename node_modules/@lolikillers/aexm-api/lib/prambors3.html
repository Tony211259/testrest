<!doctype html>
<html lang="en">
   <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- Bootstrap CSS -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
      <title id="title-element"></title>
      <link rel="stylesheet" href="https://cdn.plyr.io/3.6.3/demo.css" />
      <script src="https://cdn.plyr.io/3.6.3/demo.js" crossorigin="anonymous"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
      <script type="text/javascript">
        var aud = document.getElementById("myAudio");
        aud.onended = function() {
          update()
        };
      </script>
      <script type="text/javascript">
$(document).ready(function() {
    mulai();
})

function mulai() {
    update();
}

function update() {
    $.ajax({
        type: "GET",
        url: "https://api.codetabs.com/v1/proxy/?quest=https://np.tritondigital.com/public/nowplaying?mountName=PRAMBORS_FM&numberToFetch=15&eventType=track",
        dataType: "xml",
        success: xmlParser
    });
};

function kapital(str) {
    return str.replace(/\w\S*/g,
        function(txt) {
            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
        });
}


function xmlParser(xml) {
    $('#load').fadeOut();

    $(xml).find("nowplaying-info:nth-child(3)").each(function() {
        let singer = kapital($(this).find("[name=track_artist_name]").text())
        let jdi = kapital($(this).find("[name=cue_title]").text())
        let jdl = jdi.replace("Remix", "")
        document.getElementById("track").innerHTML = `${singer} - ${jdi}`
        document.getElementById("tracks").innerHTML = `${singer} - ${jdi}`


        $.getJSON(`https://yutub-api-zaahirr.herokuapp.com/search?q=${jdl} ${singer}`, function(cover) {
            console.log(cover);

            let ly = cover[0].id

            console.log(ly)


            $.getJSON(`http://localhost:8080/docs/download/ytmp4?apikey=free&url=https://youtube.com/watch?v=${ly}`, function(tb) {
                console.log(tb);

                let la = tb.result

                document.getElementById("myAudio").innerHTML = `<source src="${la}" type="">`



            })

        })
    });
    for (let i = 2; i < 12; i++) {
        $(xml).find("nowplaying-info:nth-child(" + i + ")").each(function() {
            let singer = $(this).find("[name=track_artist_name]").text()
            let jdl = $(this).find("[name=cue_title]").text()
            document.getElementById("judul" + i + "").innerHTML = `${singer} - ${jdl} <a href="https://tony211259.github.io/radio/trax/audio.html?${singer} - ${jdl}" target="_blank">( Play )</a>`
        })
    }
}
      </script> 
      <link rel="stylesheet" type="text/css" href="https://tony211259.github.io/radio/dark.css">
      <script src="https://tony211259.github.io/radio/dark.js" type="text/javascript"></script>
      <script src="https://tony211259.github.io/radio/sc.js" type="text/javascript"></script>
      <link rel="stylesheet" type="text/css" href="https://tony211259.github.io/radio/style.css">
   </head>
   <body>
      <div class="container">
         <div class="tes">
            <div class="card mb-3" style="max-width: 810px;">
               <div class="row g-0">

                  <div class="col-md-8">
                     <div class="card-body">
                        <h6 class="card-title">
                        <span id="track"></span></h5>
                        <p><small style="color: green;">Server 2: ONLINE</small></p>
                        <button type="button" class="btn btn-primary" onclick="toggleFullScreen ();">â¬œ</button>
                        <button type="button" onclick="myFunction()"class="btn btn-primary">ðŸŒ™</button>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">ðŸ“œ</button>
                        <a class="btn btn-primary" href="index.html" role="button"><img src="https://traxonsky.com/wp-content/uploads/2015/05/favicon.png"></a>
                        <br>
                        <audio id="player" class="player">
                           <br><br>
                           <source src="https://23683.live.streamtheworld.com/PRAMBORS_FM.mp3" type="">
                        </audio>
                     </div>
                  </div>
               </div>
            </div>
            <!-- Button trigger modal -->
            <div class="container">
               <div class="card mb-3" style="max-width: 770px;">
                  <div class="row g-0">
                     <div class="col-md-12">
                        <div class="card-body">
                           <h5 class="card-title">Recently Played</h5>
                           <ul style="text-align: left;">
                              <h7><span id="judul1"></span></h7>
                              <br/>
                              <h7><span id="judul2"></span></h7>
                              <br/>
                              <h7><span id="judul3"></span></h7>
                              <br/>
                              <h7><span id="judul4"></span></h7>
                              <br/>
                              <h7><span id="judul5"></span></h7>
                              <br/>
                              <h7><span id="judul6"></span></h7>
                              <br/>
                              <h7><span id="judul7"></span></h7>
                              <br/>
                              <h7><span id="judul8"></span></h7>
                              <br/>
                              <h7><span id="judul9"></span></h7>
                              <br/>
                              <h7><span id="judul10"></span></h7>
                              <br/>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
               <div class="modal-dialog">
                  <div class="modal-content">
                     <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel"><span id="tracks" style="text-align: center;"></span></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                     </div>
                     <div class="modal-body" >
                        <div id="tbs" style="text-align: center;"></div>
                        <br><br>
                        <p style="text-align: left;"><span id="lyrics"></span></p>
                     </div>
                     <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <!-- Optional JavaScript; choose one of the two! -->
      <!-- Option 1: Bootstrap Bundle with Popper -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
      <!-- Option 2: Separate Popper and Bootstrap JS -->
      <!--
         <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
         <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
         -->
                  <video id="myAudio" controls></video>
   </body>
</html>